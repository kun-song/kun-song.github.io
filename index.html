<!DOCTYPE html>







<html class="theme-next pisces" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="随便写写">
<meta property="og:url" content="http://songkun.me/index.html">
<meta property="og:site_name" content="随便写写">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="随便写写">






  <link rel="canonical" href="http://songkun.me/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>随便写写</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <a href="https://github.com/satansk"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Follow me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">随便写写</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://songkun.me/2018/05/11/scala-closure-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Song Kun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随便写写">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/11/scala-closure-1/" itemprop="url">
                  Scala 闭包初探
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-11 08:20:01 / 修改时间：08:54:10" itemprop="dateCreated datePublished" datetime="2018-05-11T08:20:01+08:00">2018-05-11</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是闭包？"><a href="#什么是闭包？" class="headerlink" title="什么是闭包？"></a>什么是闭包？</h2><h3 id="维基百科"><a href="#维基百科" class="headerlink" title="维基百科"></a>维基百科</h3><p>维基百科中闭包定义如下：</p>
<blockquote>
<p>In programming languages, a closure (also lexical closure or function closure) is a technique for implementing lexically scoped name binding in a language with first-class functions. Operationally, a closure is a record storing a function[a] together with an environment.[1] The environment is a mapping associating each free variable of the function (variables that are used locally, but defined in an enclosing scope) with the value or reference to which the name was bound when the closure was created.[b] A closure—unlike a plain function—allows the function to access those captured variables through the closure’s copies of their values or references, even when the function is invoked outside their scope.</p>
</blockquote>
<p>这定义非常长，我们逐句理解下：</p>
<blockquote>
<p>In programming languages, a closure (also lexical closure or function closure) is a technique for implementing <strong>lexically scoped name binding</strong> in a language with first-class functions.</p>
</blockquote>
<p>从概念角度看，在具备 first-class functions 的编程语言中，闭包是一种实现 <strong>词法作用域级别的名字绑定</strong> 的技术。</p>
<blockquote>
<p>Operationally, a closure is a record storing a function together with an <strong>environment</strong>.</p>
</blockquote>
<p>从实现角度看，闭包是保存 <strong>函数</strong> + <strong>上下文环境</strong> 的记录。</p>
<p>到此为止，从概念、实现上解释了闭包是什么，剩下的是对上下文环境的解释：</p>
<blockquote>
<p>The environment is a mapping associating each <strong>free variable</strong> of the function (variables that are used locally, but defined in an enclosing scope) with the <strong>value or reference</strong> to which the name was bound when the closure was <strong>created</strong>.</p>
</blockquote>
<p>（上下文）环境是 <strong>自动变量名字</strong> 与该名字的 <strong>值/引用</strong> 的映射（name -&gt; value），注意变量的值、引用是闭包 <strong>创建</strong> 时确定的。</p>
<p>自由变量：</p>
<ul>
<li>在函数的 enclosing scope 中定义，但在函数内部使用的变量；</li>
<li>既不在函数参数列表中，也不是函数局部变量的变量；</li>
</ul>
<blockquote>
<p>A closure—unlike a plain function—allows the function to access those <strong>captured variables</strong> through the closure’s <strong>copies</strong> of their values or references, even when the function is invoked outside their scope.</p>
</blockquote>
<p>被捕获变量：即闭包使用的自由变量，闭包中一旦引用自由变量，则称该变量被闭包捕获。</p>
<p>若语言不支持 first-class functions，则闭包与普通函数并无区别，若支持 first-class function 则两者区别巨大：</p>
<ul>
<li>闭包的上下文环境会保存被捕获的自由变量值、引用的 <strong>副本</strong>；</li>
<li>闭包作为函数返回值返回后，调用闭包，闭包中依然保存其 <strong>定义时</strong> 的自由变量的值；</li>
</ul>
<hr>
<p>总结如下：</p>
<ul>
<li>闭包 = 函数 + 上下文环境</li>
<li>上下文环境 = 自由变量名字 -&gt; 值/引用（key -&gt; value）</li>
<li>自由变量 = 在函数的 enclosing scope 定义，在函数内部引用的变量</li>
<li>上下文环境中保存的 value/reference 是闭包 <strong>定义</strong> 时的 <strong>副本</strong></li>
<li></li>
</ul>
<h3 id="我的理解"><a href="#我的理解" class="headerlink" title="我的理解"></a>我的理解</h3><p>闭包英文是 closure，更精确一点，闭包是 “first-class function with lexical scope”，即具备词法作用域的第一等函数，要理解这句话，首先要明白两个概念：</p>
<ul>
<li>词法作用域</li>
<li>第一等函数</li>
</ul>
<p>稍微有点 FP 基础的同学肯定了解第一等函数，即在编程语言中，函数是第一等公民，与普通值没有任何区别，因此函数既可以用作函数参数，也可以用作函数返回值。</p>
<h2 id="Scala-中的闭包"><a href="#Scala-中的闭包" class="headerlink" title="Scala 中的闭包"></a>Scala 中的闭包</h2>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://songkun.me/2018/05/09/how-to-learn-scala/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Song Kun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="随便写写">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/09/how-to-learn-scala/" itemprop="url">
                  如何学习 Scala
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-09 23:12:42" itemprop="dateCreated datePublished" datetime="2018-05-09T23:12:42+08:00">2018-05-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-14 08:56:23" itemprop="dateModified" datetime="2018-05-14T08:56:23+08:00">2018-05-14</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>虽然文章名字是如何学习 Scala，但实际上是我过去一年 Scala 学习过程的总结，希望对初学者有所帮助。</p>
<h2 id="初次接触"><a href="#初次接触" class="headerlink" title="初次接触"></a>初次接触</h2><p>说来有趣，大约一年以前，我转到一个新的项目组，晨会上了解到有同事正在调研 Scala，每天该同事都汇报调研进度（虽然一般是还没开始、下周开始云云），我那时候刚转正，想着既然以后可能用到，那我得提前学习，毕竟机遇总是留给有准备的人，于是在业余时间我开始学习 Scala。</p>
<h2 id="难以入门"><a href="#难以入门" class="headerlink" title="难以入门"></a>难以入门</h2><p>当时在知乎搜索了很多如何学习 Scala 的文章，看到很多人推荐《Scala 函数式编程》这本书（著名的小红书），我当然知道这书很难，但当时蜜汁自信，认为看书就要看最经典、最难的，虽然进度可能很慢，但收获也最大不是吗？</p>
<p>开始看书以后，我发现除了第一章读起来比较顺畅，从第二章开始就很吃力了。苦苦挣扎了几个周，加上上半年加班非常多，导致学习效果很不好。</p>
<p>而同事对 Scala 的调研早已结束，连个结论都没给出，Scala 毕竟偏向后端，让前端同事去调研，结果可想而知。</p>
<p>这段时间的学习让我熟悉了很多函数式编程的术语，自己对函数式编程也越来越感兴趣，但 Scala 并没有入门，而且 Scala 给我留下了难以学习的印象。</p>
<h2 id="初窥门径"><a href="#初窥门径" class="headerlink" title="初窥门径"></a>初窥门径</h2><p>时间一晃到了去年的 7 月份，这时项目加班终于少了一些，而我按捺不住对 Scala 的好奇心，又一次尝试学习，这次我决定从公开课入手，开始学习知乎神课 <a href="https://www.coursera.org/learn/programming-languages/home/welcome" target="_blank" rel="noopener">Programming Languanges</a>，关于该课程的评价建议参考很多知乎回答，一句话总结：函数式编程入门不二之选，对学习 Scala 也大有裨益。</p>
<p>不得不说，这门课真的是物超所值，我那段时间只跟了 Part A，使用 Standard ML 讲述函数式编程的基本概念，例如：</p>
<ul>
<li>list 组合子（map, filter, fold 等）</li>
<li>first-class function, high order function, closure, currying, partially applied function …</li>
</ul>
<p>这些概念今天来看非常基础，但对一个毫无函数式编程基础的人来说是很头大的，非常建议大家学习下这门课，对于入门 Scala 非常有用，因为 Scala 的函数式方面与 Standard ML 非常类似（当然与 Haskell 更类似），公开课最大的优点是有练习，有实际编程机会，这对于入门学习是很重要的。</p>
<p>后来我又跟了 Scala 之父 Martin Odersky 的一门课：<a href="https://www.coursera.org/learn/progfun1/home/welcome" target="_blank" rel="noopener">Functional Programming Principles in Scala</a>，这门课主要讲述 Scala 的函数式编程，对面向对象几乎只字未提，习题稍微有点难度。</p>
<p>实事求是的讲，这门课比 Programming Languages 还是略逊一筹，课程内容不是很连贯，所以我认为最好先学下 Programming Languages Part A，然后在跟这门课，事半功倍。</p>
<p>跟完这两门公开课我对 Scala，或更广义的函数式编程基本入门了，剩下的就是实践了。</p>
<h2 id="渐入佳境"><a href="#渐入佳境" class="headerlink" title="渐入佳境"></a>渐入佳境</h2><p>前面说过，项目组对 Scala 的调研虎头蛇尾，不了了之，我这 Scala 无用武之地了啊。</p>
<h2 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h2>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Song Kun</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/satansk" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:songkun.fp@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Song Kun</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Pisces</a> v6.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
















  
  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.2.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
